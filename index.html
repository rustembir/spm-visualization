<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –≤—ã–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–∏—á–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–í–ü–£/SPM) - 3D –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            overflow: hidden;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        #info-panel h1 {
            color: #1e3c72;
            font-size: 24px;
            margin-bottom: 10px;
            border-bottom: 2px solid #2a5298;
            padding-bottom: 10px;
        }

        #component-info {
            background: rgba(255, 255, 255, 0.98);
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 20px;
            border-radius: 10px;
            min-width: 350px;
            max-width: 450px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: none;
        }

        #component-info.active {
            display: block;
        }

        .component-title {
            font-size: 18px;
            color: #1e3c72;
            margin-bottom: 15px;
            font-weight: bold;
            border-bottom: 2px solid #2a5298;
            padding-bottom: 8px;
        }

        .component-detail {
            margin: 8px 0;
            display: flex;
            align-items: center;
        }

        .component-detail span {
            font-weight: bold;
            color: #2a5298;
            margin-right: 8px;
            min-width: 120px;
        }

        .hs-code {
            background: #e8f4f8;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #1e3c72;
            font-weight: bold;
        }

        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        button {
            background: #2a5298;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #1e3c72;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        #legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
            border: 1px solid #ccc;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            pointer-events: none;
            display: none;
            z-index: 1000;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .stats {
            background: #f0f8ff;
            padding: 10px;
            margin-top: 15px;
            border-radius: 5px;
            border-left: 4px solid #2a5298;
        }

        .stats-item {
            margin: 5px 0;
            font-size: 14px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: #fff;
            margin: 2% auto;
            padding: 20px;
            border-radius: 10px;
            width: 95%;
            max-width: 1400px;
            height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #2a5298;
        }

        .modal-header h2 {
            color: #1e3c72;
            margin: 0;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #1e3c72;
        }

        .table-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .filter-select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .table-container {
            flex: 1;
            overflow: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .data-table th {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 12px;
            text-align: left;
            position: sticky;
            top: 0;
            cursor: pointer;
            user-select: none;
        }

        .data-table th:hover {
            background: linear-gradient(135deg, #1e3c72 0%, #152a52 100%);
        }

        .data-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .data-table tr:hover {
            background-color: #f0f8ff;
        }

        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .hs-code-cell {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #1e3c72;
        }

        .duty-rate {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
        }

        .duty-rate.low {
            background: #d4edda;
            color: #155724;
        }

        .duty-rate.medium {
            background: #fff3cd;
            color: #856404;
        }

        .duty-rate.high {
            background: #f8d7da;
            color: #721c24;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
        }

        .export-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .export-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .table-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            padding: 10px;
            background: #f0f8ff;
            border-radius: 5px;
            font-size: 14px;
        }

        .stat-badge {
            padding: 5px 10px;
            background: white;
            border-radius: 3px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div id="canvas-container">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ 3D –º–æ–¥–µ–ª–∏...</div>
    </div>

    <div id="info-panel">
        <h1>–°–∏—Å—Ç–µ–º–∞ –í–ü–£ / SPM</h1>
        <p style="margin-bottom: 10px; color: #666;">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</p>
        <div class="stats">
            <div class="stats-item">üìä –í—Å–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: <strong>208</strong></div>
            <div class="stats-item">üè≠ –û—Å–Ω–æ–≤–Ω—ã–µ —É–∑–ª—ã: <strong>9</strong></div>
            <div class="stats-item">üìã –ö–æ–¥–æ–≤ –¢–ù –í–≠–î: <strong>87</strong></div>
            <div class="stats-item">üí∞ –¢–∞–º–æ–∂–µ–Ω–Ω–∞—è –ø–æ—à–ª–∏–Ω–∞: <strong>0-15%</strong></div>
        </div>
        <p style="margin-top: 15px; font-size: 12px; color: #888;">
            üí° –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π.<br>
            üñ±Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º—ã—à—å –¥–ª—è –≤—Ä–∞—â–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.
        </p>
    </div>

    <!-- –õ–æ–≥–æ—Ç–∏–ø HScan -->
    <!-- –î–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞ –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ data:image –Ω–∞ base64 –≤–∞—à–µ–≥–æ PNG —Ñ–∞–π–ª–∞ -->
    <div id="hscan-logo" style="position: absolute; top: 20px; right: 20px; background: white; padding: 15px 20px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3); display: flex; align-items: center; gap: 15px; z-index: 100;">
        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #3B82C4 0%, #2563EB 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; position: relative; box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);">
            <!-- HS —Ç–µ–∫—Å—Ç -->
            <div style="width: 35px; height: 30px; background: white; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                <span style="color: #3B82C4; font-weight: bold; font-size: 16px; font-family: 'Arial Black', sans-serif;">HS</span>
            </div>
            <!-- –£–≥–æ–ª–∫–∏ —Å–∫–∞–Ω–µ—Ä–∞ -->
            <div style="position: absolute; top: 6px; left: 6px; width: 12px; height: 12px; border-top: 3px solid white; border-left: 3px solid white;"></div>
            <div style="position: absolute; top: 6px; right: 6px; width: 12px; height: 12px; border-top: 3px solid white; border-right: 3px solid white;"></div>
            <div style="position: absolute; bottom: 6px; left: 6px; width: 12px; height: 12px; border-bottom: 3px solid white; border-left: 3px solid white;"></div>
            <div style="position: absolute; bottom: 6px; right: 6px; width: 12px; height: 12px; border-bottom: 3px solid white; border-right: 3px solid white;"></div>
            <!-- –õ–∏–Ω–∏–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); width: 80%; height: 2px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);"></div>
        </div>
        <div style="display: flex; flex-direction: column;">
            <span style="font-size: 28px; font-weight: 700; color: #1e293b; font-family: 'Segoe UI', Arial, sans-serif; letter-spacing: -0.5px;">HScan</span>
            <span style="font-size: 11px; color: #64748b; margin-top: -2px; font-weight: 500;">HS Code Scanner</span>
        </div>
    </div>
    
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞
        function loadExternalLogo() {
            // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø –∏–∑ —Ç–æ–π –∂–µ –ø–∞–ø–∫–∏, —á—Ç–æ –∏ HTML —Ñ–∞–π–ª
            const img = new Image();
            img.onload = function() {
                const logoDiv = document.getElementById('hscan-logo');
                if (logoDiv) {
                    // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    logoDiv.innerHTML = '';
                    logoDiv.style.padding = '0';
                    logoDiv.style.background = 'transparent';
                    logoDiv.style.boxShadow = 'none';
                    
                    img.style.height = '80px';
                    img.style.width = 'auto';
                    img.style.display = 'block';
                    logoDiv.appendChild(img);
                }
            };
            img.onerror = function() {
                console.log('–í–Ω–µ—à–Ω–∏–π –ª–æ–≥–æ—Ç–∏–ø HScan_logo.png –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π');
            };
            // –ò—â–µ–º —Ñ–∞–π–ª –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ HTML
            img.src = 'HScan_logo.png';
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', loadExternalLogo);
    </script>

    <div id="component-info">
        <div class="component-title" id="component-name">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç</div>
        <div class="component-detail">
            <span>–ö–æ–¥ –¢–ù –í–≠–î:</span>
            <span class="hs-code" id="component-hs-code">-</span>
        </div>
        <div class="component-detail">
            <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
            <span id="component-qty">-</span>
        </div>
        <div class="component-detail">
            <span>–ü–æ—à–ª–∏–Ω–∞:</span>
            <span id="component-duty">-</span>
        </div>
        <div class="component-detail">
            <span>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</span>
            <span id="component-manufacturer">-</span>
        </div>
        <div class="component-detail">
            <span>–°—Ç—Ä–∞–Ω–∞:</span>
            <span id="component-country">-</span>
        </div>
        <div class="component-detail" style="margin-top: 10px;">
            <span>–û–ø–∏—Å–∞–Ω–∏–µ:</span>
        </div>
        <p id="component-description" style="color: #666; font-size: 14px; line-height: 1.4;">-</p>
    </div>

    <div id="controls">
        <button onclick="toggleRotation()">üîÑ –í—Ä–∞—â–µ–Ω–∏–µ</button>
        <button onclick="resetView()">üè† –°–±—Ä–æ—Å –≤–∏–¥–∞</button>
        <button onclick="toggleLabels()">üè∑Ô∏è –ú–µ—Ç–∫–∏</button>
        <button onclick="exportData()">üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
        <button onclick="showDataTable()">üìã –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</button>
    </div>

    <div id="legend">
        <h3 style="margin-bottom: 10px; color: #1e3c72;">–õ–µ–≥–µ–Ω–¥–∞</h3>
        <div class="legend-item">
            <div class="legend-color" style="background: #FFD700;"></div>
            <span>–ë—É–π (89079000)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #4169E1;"></div>
            <span>–ü–æ–¥–≤–æ–¥–Ω—ã–µ —à–ª–∞–Ω–≥–∏ (40094200)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF6347;"></div>
            <span>–ü–ª–∞–≤—É—á–∏–µ —à–ª–∞–Ω–≥–∏ (40094200)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #808080;"></div>
            <span>–Ø–∫–æ—Ä–Ω—ã–µ —Ü–µ–ø–∏ (73158200)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #8B4513;"></div>
            <span>–®–≤–∞—Ä—Ç–æ–≤—ã–µ —Ç—Ä–æ—Å—ã (56075011)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #00CED1;"></div>
            <span>–û–ü–¢–ú (73089098)</span>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ç–∞–±–ª–∏—Ü–µ–π –¥–∞–Ω–Ω—ã—Ö -->
    <div id="dataModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ SPM —Å –∫–æ–¥–∞–º–∏ –¢–ù –í–≠–î</h2>
                <span class="close" onclick="closeDataTable()">&times;</span>
            </div>
            
            <div class="table-controls">
                <input type="text" class="search-box" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–µ..." onkeyup="filterTable()">
                
                <select class="filter-select" id="categoryFilter" onchange="filterTable()">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <option value="G">–û–±—â–µ–µ (G)</option>
                    <option value="M">–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–µ (M)</option>
                    <option value="P">–¢—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥—ã (P)</option>
                    <option value="E&I">–≠–ª–µ–∫—Ç—Ä–æ –∏ –ö–ò–ü (E&I)</option>
                    <option value="L">–ú–æ—Ä—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (L)</option>
                    <option value="S">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (S)</option>
                    <option value="C">–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ (C)</option>
                    <option value="X">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ (X)</option>
                </select>
                
                <select class="filter-select" id="dutyFilter" onchange="filterTable()">
                    <option value="">–í—Å–µ –ø–æ—à–ª–∏–Ω—ã</option>
                    <option value="0%">0% (–±–µ—Å–ø–æ—à–ª–∏–Ω–Ω–æ)</option>
                    <option value="3%">3%</option>
                    <option value="5%">5%</option>
                    <option value="10%">10%</option>
                    <option value="15%">15%</option>
                </select>
                
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToCSV()">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="export-btn" onclick="exportToExcel()">üì• –≠–∫—Å–ø–æ—Ä—Ç Excel</button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">ID ‚Üï</th>
                            <th onclick="sortTable(1)">–¢–µ–≥ ‚Ññ</th>
                            <th onclick="sortTable(2)">–ö–æ–¥ –¢–ù –í–≠–î ‚Üï</th>
                            <th onclick="sortTable(3)">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                            <th onclick="sortTable(4)">–ö–æ–ª-–≤–æ</th>
                            <th onclick="sortTable(5)">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</th>
                            <th onclick="sortTable(6)">–°—Ç—Ä–∞–Ω–∞</th>
                            <th onclick="sortTable(7)">–ü–æ—à–ª–∏–Ω–∞ ‚Üï</th>
                            <th onclick="sortTable(8)">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </tbody>
                </table>
            </div>
            
            <div class="table-stats">
                <div class="stat-badge">
                    <strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong> <span id="totalRecords">0</span>
                </div>
                <div class="stat-badge">
                    <strong>–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ:</strong> <span id="filteredRecords">0</span>
                </div>
                <div class="stat-badge">
                    <strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤ –¢–ù –í–≠–î:</strong> <span id="uniqueCodes">0</span>
                </div>
                <div class="stat-badge">
                    <strong>–°—Ä–µ–¥–Ω—è—è –ø–æ—à–ª–∏–Ω–∞:</strong> <span id="avgDuty">0%</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Three.js
        let scene, camera, renderer;
        let spmSystem = {};
        let raycaster, mouse;
        let isRotating = true;
        let showLabels = true;
        let labels = [];

        // –î–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ SPM
        const spmComponents = {
            buoy: {
                name: "–ë—É–π / Single Point Mooring System",
                hsCode: "89079000",
                duty: "15%",
                qty: "2 —à—Ç",
                manufacturer: "Drydocks World Dubai",
                country: "–û–ê–≠",
                description: "–û—Å–Ω–æ–≤–Ω–æ–π –ø–ª–∞–≤—É—á–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –≤—Ä–∞—â–µ–Ω–∏–µ —Ç–∞–Ω–∫–µ—Ä–∞ –≤–æ–∫—Ä—É–≥ —Ç–æ—á–∫–∏ —à–≤–∞—Ä—Ç–æ–≤–∫–∏",
                color: 0xFFD700,
                position: { x: 0, y: 5, z: 0 }
            },
            underwaterHoses: {
                name: "–ü–æ–¥–≤–æ–¥–Ω—ã–µ —à–ª–∞–Ω–≥–∏",
                hsCode: "40094200",
                duty: "3%",
                qty: "18 —à—Ç",
                manufacturer: "Yokohama",
                country: "–Ø–ø–æ–Ω–∏—è",
                description: "–ì–∏–±–∫–∏–µ —à–ª–∞–Ω–≥–∏ –¥–ª—è –ø–æ–¥–≤–æ–¥–Ω–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–µ—Ñ—Ç–∏ –æ—Ç –º–æ—Ä—Å–∫–æ–≥–æ –¥–Ω–∞ –∫ –±—É—é",
                color: 0x4169E1,
                position: { x: 0, y: -10, z: 0 }
            },
            floatingHoses: {
                name: "–ü–ª–∞–≤—É—á–∏–µ —à–ª–∞–Ω–≥–∏",
                hsCode: "40094200",
                duty: "3%",
                qty: "12 —à—Ç",
                manufacturer: "Yokohama",
                country: "–Ø–ø–æ–Ω–∏—è",
                description: "–ü–ª–∞–≤–∞—é—â–∏–µ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ —à–ª–∞–Ω–≥–∏ –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –±—É—è —Å —Ç–∞–Ω–∫–µ—Ä–æ–º",
                color: 0xFF6347,
                position: { x: 15, y: 0, z: 0 }
            },
            anchorChains: {
                name: "–Ø–∫–æ—Ä–Ω—ã–µ —Ü–µ–ø–∏",
                hsCode: "73158200",
                duty: "15%",
                qty: "6 –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤",
                manufacturer: "Vicinay Cadenas",
                country: "–ò—Å–ø–∞–Ω–∏—è",
                description: "–í—ã—Å–æ–∫–æ–ø—Ä–æ—á–Ω—ã–µ —Ü–µ–ø–∏ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –±—É—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏",
                color: 0x808080,
                position: { x: -10, y: -15, z: 10 }
            },
            mooringRopes: {
                name: "–®–≤–∞—Ä—Ç–æ–≤—ã–µ —Ç—Ä–æ—Å—ã",
                hsCode: "56075011",
                duty: "15%",
                qty: "4 –∫–æ–º–ø–ª–µ–∫—Ç–∞",
                manufacturer: "Lankhorst Ropes",
                country: "–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã",
                description: "–°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–æ—Å—ã –¥–ª—è —à–≤–∞—Ä—Ç–æ–≤–∫–∏ —Ç–∞–Ω–∫–µ—Ä–∞ –∫ –±—É—é",
                color: 0x8B4513,
                position: { x: 10, y: 3, z: -10 }
            },
            plem: {
                name: "–û–ü–¢–ú (–û–ø–æ—Ä–Ω–æ-–ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–π —Ç—Ä—É–±–Ω—ã–π –º–∞–Ω–∏—Ñ–æ–ª—å–¥)",
                hsCode: "73089098",
                duty: "10%",
                qty: "1 –∫–æ–º–ø–ª–µ–∫—Ç",
                manufacturer: "FMC Technologies",
                country: "–°–®–ê",
                description: "–ü–æ–¥–≤–æ–¥–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ –Ω–µ—Ñ—Ç–∏",
                color: 0x00CED1,
                position: { x: 0, y: -20, z: 0 }
            },
            turntable: {
                name: "–ü–æ–≤–æ—Ä–æ—Ç–Ω—ã–π —Å—Ç–æ–ª",
                hsCode: "84825000",
                duty: "0%",
                qty: "2 —à—Ç",
                manufacturer: "SKF",
                country: "–®–≤–µ—Ü–∏—è",
                description: "–ú–µ—Ö–∞–Ω–∏–∑–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ –±—É—è",
                color: 0x32CD32,
                position: { x: 0, y: 4, z: 0 }
            },
            swivel: {
                name: "–í–µ—Ä—Ç–ª—é–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π",
                hsCode: "73079980",
                duty: "5%",
                qty: "2 —à—Ç",
                manufacturer: "Emco Wheaton",
                country: "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è",
                description: "–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É –∂–∏–¥–∫–æ—Å—Ç–∏ –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏ –±—É—è",
                color: 0xFFA500,
                position: { x: 0, y: 6, z: 0 }
            },
            hawser: {
                name: "–®–≤–∞—Ä—Ç–æ–≤–Ω—ã–π —Ç—Ä–æ—Å —Ç–∞–Ω–∫–µ—Ä–∞",
                hsCode: "56079090",
                duty: "10%",
                qty: "2 –∫–æ–º–ø–ª–µ–∫—Ç–∞",
                manufacturer: "Samson Rope",
                country: "–°–®–ê",
                description: "–û—Å–Ω–æ–≤–Ω–æ–π —Ç—Ä–æ—Å –¥–ª—è –∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ç–∞–Ω–∫–µ—Ä–∞ –∫ –±—É—é",
                color: 0x4B0082,
                position: { x: 20, y: 2, z: 0 }
            }
        };

        function init() {
            // –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x2a5298, 100, 500);

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                0.1,
                1000
            );
            camera.position.set(60, 25, 60);
            camera.lookAt(0, 0, 0);

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            // –û—Å–≤–µ—â–µ–Ω–∏–µ
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(50, 100, 50);
            directionalLight.castShadow = true;
            directionalLight.shadow.camera.near = 0.1;
            directionalLight.shadow.camera.far = 500;
            directionalLight.shadow.camera.left = -100;
            directionalLight.shadow.camera.right = 100;
            directionalLight.shadow.camera.top = 100;
            directionalLight.shadow.camera.bottom = -100;
            scene.add(directionalLight);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è raycaster –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ SPM
            createSPMSystem();

            // –°–æ–∑–¥–∞–Ω–∏–µ –≤–æ–¥–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
            createWaterSurface();

            // –°–æ–∑–¥–∞–Ω–∏–µ –º–æ—Ä—Å–∫–æ–≥–æ –¥–Ω–∞
            createSeabed();

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–µ–π –º—ã—à–∏
            addMouseControls();

            // –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            document.querySelector('.loading').style.display = 'none';

            // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
            animate();
        }

        function createSPMSystem() {
            // –ë—É–π - –æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞–≤—É—á–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
            const buoyGeometry = new THREE.CylinderGeometry(8, 10, 8, 32);
            const buoyMaterial = new THREE.MeshPhongMaterial({
                color: spmComponents.buoy.color,
                emissive: spmComponents.buoy.color,
                emissiveIntensity: 0.1
            });
            const buoy = new THREE.Mesh(buoyGeometry, buoyMaterial);
            buoy.position.set(0, 3, 0); // –ë—É–π –Ω–µ–º–Ω–æ–≥–æ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –Ω–∞–¥ –≤–æ–¥–æ–π
            buoy.castShadow = true;
            buoy.userData = spmComponents.buoy;
            scene.add(buoy);
            spmSystem.buoy = buoy;

            // –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å –±—É—è —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º
            const topGeometry = new THREE.BoxGeometry(6, 4, 6);
            const topMaterial = new THREE.MeshPhongMaterial({
                color: 0xFFFF00,
                emissive: 0xFFFF00,
                emissiveIntensity: 0.05
            });
            const topStructure = new THREE.Mesh(topGeometry, topMaterial);
            topStructure.position.set(0, 8, 0); // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–µ–º
            topStructure.userData = spmComponents.turntable;
            scene.add(topStructure);

            // –ü–æ–≤–æ—Ä–æ—Ç–Ω—ã–π —Å—Ç–æ–ª (–≤–Ω—É—Ç—Ä–∏ –±—É—è)
            const turntableGeometry = new THREE.CylinderGeometry(5, 5, 2, 32);
            const turntableMaterial = new THREE.MeshPhongMaterial({
                color: spmComponents.turntable.color,
                emissive: spmComponents.turntable.color,
                emissiveIntensity: 0.05
            });
            const turntable = new THREE.Mesh(turntableGeometry, turntableMaterial);
            turntable.position.set(0, 2, 0); // –í–Ω—É—Ç—Ä–∏ –±—É—è
            turntable.userData = spmComponents.turntable;
            scene.add(turntable);

            // –í–µ—Ä—Ç–ª—é–≥
            const swivelGeometry = new THREE.CylinderGeometry(2, 2, 3, 16);
            const swivelMaterial = new THREE.MeshPhongMaterial({
                color: spmComponents.swivel.color,
                metalness: 0.7,
                roughness: 0.3
            });
            const swivel = new THREE.Mesh(swivelGeometry, swivelMaterial);
            swivel.position.set(0, 5, 0); // –ù–∞–¥ –±—É–µ–º
            swivel.userData = spmComponents.swivel;
            scene.add(swivel);

            // –ü–ª–∞–≤—É—á–∏–µ —à–ª–∞–Ω–≥–∏ - –∏–¥—É—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–¥ —É–≥–ª–æ–º 45 –≥—Ä–∞–¥—É—Å–æ–≤ –æ—Ç –±—É—è
            for (let i = 0; i < 3; i++) {
                const baseAngle = (Math.PI / 4) + (i * Math.PI / 12); // –í–µ–µ—Ä –æ—Ç 45 –¥–æ 60 –≥—Ä–∞–¥—É—Å–æ–≤
                
                const curve = new THREE.CatmullRomCurve3([
                    new THREE.Vector3(6, 1, 0), // –ù–∞—á–∞–ª–æ –æ—Ç –∫—Ä–∞—è –±—É—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤–æ–¥—ã
                    new THREE.Vector3(
                        6 + Math.cos(baseAngle) * 8,
                        0.5,
                        Math.sin(baseAngle) * 8
                    ), // –ò–¥–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É –ø–æ–¥ —É–≥–ª–æ–º
                    new THREE.Vector3(
                        6 + Math.cos(baseAngle) * 16,
                        0,
                        Math.sin(baseAngle) * 16
                    ), // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
                    new THREE.Vector3(
                        6 + Math.cos(baseAngle) * 25,
                        0,
                        Math.sin(baseAngle) * 25
                    ), // –ù–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã
                    new THREE.Vector3(
                        6 + Math.cos(baseAngle) * 35,
                        0,
                        Math.sin(baseAngle) * 35
                    ) // –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –¥–∞–ª–µ–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω–µ
                ]);
                
                const tubeGeometry = new THREE.TubeGeometry(curve, 30, 1.2, 12, false);
                const tubeMaterial = new THREE.MeshPhongMaterial({
                    color: spmComponents.floatingHoses.color,
                    emissive: spmComponents.floatingHoses.color,
                    emissiveIntensity: 0.05,
                    roughness: 0.4,
                    metalness: 0.2
                });
                const hose = new THREE.Mesh(tubeGeometry, tubeMaterial);
                hose.userData = spmComponents.floatingHoses;
                hose.castShadow = true;
                scene.add(hose);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –±—É–π–∫–∏ –Ω–∞ –ø–ª–∞–≤—É—á–∏–µ —à–ª–∞–Ω–≥–∏
                for (let j = 1; j <= 4; j++) {
                    const t = j * 0.2;
                    const point = curve.getPoint(t);
                    const buoyGeometry = new THREE.CylinderGeometry(1.5, 1.5, 0.8, 8);
                    const buoyMaterial = new THREE.MeshPhongMaterial({
                        color: 0xFFA500,
                        emissive: 0xFFA500,
                        emissiveIntensity: 0.1
                    });
                    const buoy = new THREE.Mesh(buoyGeometry, buoyMaterial);
                    buoy.position.copy(point);
                    buoy.position.y += 0.5;
                    scene.add(buoy);
                }
            }

            // –ü–æ–¥–≤–æ–¥–Ω—ã–µ —à–ª–∞–Ω–≥–∏ - –∏–¥—É—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –∑–∞—Ç–µ–º –≤–Ω–∏–∑
            for (let i = 0; i < 4; i++) {
                const angle = (i * Math.PI * 2) / 4; // –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –∫—Ä—É–≥—É
                
                const curve = new THREE.CatmullRomCurve3([
                    new THREE.Vector3(
                        Math.cos(angle) * 6, 
                        -1, 
                        Math.sin(angle) * 6
                    ), // –ù–∞—á–∞–ª–æ –æ—Ç –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ –±—É—è (–ø–æ–¥ –≤–æ–¥–æ–π)
                    new THREE.Vector3(
                        Math.cos(angle) * 10, 
                        -2, 
                        Math.sin(angle) * 10
                    ), // –ò–¥–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å –Ω–µ–±–æ–ª—å—à–∏–º –æ–ø—É—Å–∫–∞–Ω–∏–µ–º
                    new THREE.Vector3(
                        Math.cos(angle) * 15, 
                        -5, 
                        Math.sin(angle) * 15
                    ), // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É
                    new THREE.Vector3(
                        Math.cos(angle) * 20, 
                        -10, 
                        Math.sin(angle) * 20
                    ), // –ù–∞—á–∏–Ω–∞–µ–º –æ–ø—É—Å–∫–∞—Ç—å—Å—è –∫—Ä—É—á–µ
                    new THREE.Vector3(
                        Math.cos(angle) * 23, 
                        -15, 
                        Math.sin(angle) * 23
                    ), // –û–ø—É—Å–∫–∞–µ–º—Å—è –≥–ª—É–±–∂–µ
                    new THREE.Vector3(
                        Math.cos(angle) * 25, 
                        -20, 
                        Math.sin(angle) * 25
                    ) // –ö–æ–Ω–µ—Ü —É –û–ü–¢–ú
                ]);

                const tubeGeometry = new THREE.TubeGeometry(curve, 30, 0.9, 12, false);
                const tubeMaterial = new THREE.MeshPhongMaterial({
                    color: spmComponents.underwaterHoses.color,
                    emissive: spmComponents.underwaterHoses.color,
                    emissiveIntensity: 0.03,
                    transparent: true,
                    opacity: 0.9,
                    roughness: 0.5,
                    metalness: 0.3
                });
                const hose = new THREE.Mesh(tubeGeometry, tubeMaterial);
                hose.userData = spmComponents.underwaterHoses;
                hose.castShadow = true;
                hose.receiveShadow = true;
                scene.add(hose);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–Ω—Ü—ã –Ω–∞ –∫–æ–Ω—Ü–∞—Ö
                const flangeGeometry = new THREE.CylinderGeometry(1.5, 1.5, 0.5, 12);
                const flangeMaterial = new THREE.MeshPhongMaterial({
                    color: 0x696969,
                    metalness: 0.9,
                    roughness: 0.1
                });
                
                // –§–ª–∞–Ω–µ—Ü —É –±—É—è
                const flange1 = new THREE.Mesh(flangeGeometry, flangeMaterial);
                flange1.position.set(
                    Math.cos(angle) * 6, 
                    -1, 
                    Math.sin(angle) * 6
                );
                scene.add(flange1);
                
                // –§–ª–∞–Ω–µ—Ü —É –û–ü–¢–ú
                const flange2 = new THREE.Mesh(flangeGeometry, flangeMaterial);
                flange2.position.set(
                    Math.cos(angle) * 25, 
                    -20, 
                    Math.sin(angle) * 25
                );
                scene.add(flange2);
            }

            // –Ø–∫–æ—Ä–Ω—ã–µ —Ü–µ–ø–∏ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –ø—Ä–æ–≤–∏—Å–∞–Ω–∏–µ–º (–∫–∞—Ç–µ–Ω–∞—Ä–Ω–∞—è –∫—Ä–∏–≤–∞—è)
            for (let i = 0; i < 6; i++) {
                const angle = (i * Math.PI * 2) / 6;
                const chainStartRadius = 8;
                const chainEndRadius = 45;
                
                // –°–æ–∑–¥–∞–µ–º —Ç–æ—á–∫–∏ –¥–ª—è –∫–∞—Ç–µ–Ω–∞—Ä–Ω–æ–π –∫—Ä–∏–≤–æ–π
                const points = [];
                const numPoints = 20;
                
                for (let j = 0; j <= numPoints; j++) {
                    const t = j / numPoints;
                    const radius = chainStartRadius + (chainEndRadius - chainStartRadius) * t;
                    
                    // –ö–∞—Ç–µ–Ω–∞—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –ø—Ä–æ–≤–∏—Å–∞–Ω–∏—è
                    const sag = 10 * Math.sinh(2 * (t - 0.5)) + 5;
                    const y = -t * 23 - Math.abs(sag) * 0.3; // –ì–ª—É–±–∏–Ω–∞ –¥–æ 23–º
                    
                    points.push(new THREE.Vector3(
                        Math.cos(angle) * radius,
                        y,
                        Math.sin(angle) * radius
                    ));
                }
                
                const chainCurve = new THREE.CatmullRomCurve3(points);
                const chainGeometry = new THREE.TubeGeometry(chainCurve, 30, 0.4, 8, false);
                const chainMaterial = new THREE.MeshPhongMaterial({
                    color: spmComponents.anchorChains.color,
                    metalness: 0.9,
                    roughness: 0.2,
                    emissive: 0x202020,
                    emissiveIntensity: 0.01
                });
                const chain = new THREE.Mesh(chainGeometry, chainMaterial);
                chain.userData = spmComponents.anchorChains;
                chain.castShadow = true;
                scene.add(chain);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —è–∫–æ—Ä—å –≤ –∫–æ–Ω—Ü–µ —Ü–µ–ø–∏
                const anchorGeometry = new THREE.ConeGeometry(1.5, 3, 4);
                const anchorMaterial = new THREE.MeshPhongMaterial({
                    color: 0x404040,
                    metalness: 0.9,
                    roughness: 0.3
                });
                const anchor = new THREE.Mesh(anchorGeometry, anchorMaterial);
                anchor.position.set(
                    Math.cos(angle) * chainEndRadius,
                    -23, // –ù–∞ –º–æ—Ä—Å–∫–æ–º –¥–Ω–µ
                    Math.sin(angle) * chainEndRadius
                );
                anchor.rotation.z = Math.PI;
                scene.add(anchor);
            }

            // –û–ü–¢–ú –Ω–∞ –º–æ—Ä—Å–∫–æ–º –¥–Ω–µ - —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –∏ –±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω—ã–π
            const plemGeometry = new THREE.BoxGeometry(16, 6, 16);
            const plemMaterial = new THREE.MeshPhongMaterial({
                color: spmComponents.plem.color,
                metalness: 0.7,
                roughness: 0.3,
                emissive: spmComponents.plem.color,
                emissiveIntensity: 0.05
            });
            const plem = new THREE.Mesh(plemGeometry, plemMaterial);
            plem.position.set(0, -20, 0); // –û–ü–¢–ú –Ω–∞ –¥–Ω–µ
            plem.userData = spmComponents.plem;
            plem.castShadow = true;
            scene.add(plem);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏ –Ω–∞ –û–ü–¢–ú
            const plemDetailGeometry = new THREE.CylinderGeometry(2, 2, 8, 8);
            const plemDetailMaterial = new THREE.MeshPhongMaterial({
                color: 0x4682B4,
                metalness: 0.8,
                roughness: 0.2
            });
            for (let i = 0; i < 4; i++) {
                const detail = new THREE.Mesh(plemDetailGeometry, plemDetailMaterial);
                const angle = (i * Math.PI * 2) / 4;
                detail.position.set(
                    Math.cos(angle) * 5,
                    -17, // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ–¥–Ω–∏–º–∞–µ–º –¥–µ—Ç–∞–ª–∏
                    Math.sin(angle) * 5
                );
                scene.add(detail);
            }

            // –¢—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥—ã –æ—Ç –û–ü–¢–ú - –∏–¥—É—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã
            for (let i = 0; i < 4; i++) {
                const angle = (i * Math.PI * 2) / 4 + Math.PI / 4; // –°–º–µ—â–∞–µ–º –Ω–∞ 45 –≥—Ä–∞–¥—É—Å–æ–≤
                const pipeLength = 30;
                
                const pipeGeometry = new THREE.CylinderGeometry(0.6, 0.6, pipeLength);
                const pipeMaterial = new THREE.MeshPhongMaterial({
                    color: 0x696969,
                    metalness: 0.8,
                    roughness: 0.2,
                    emissive: 0x202020,
                    emissiveIntensity: 0.02
                });
                const pipe = new THREE.Mesh(pipeGeometry, pipeMaterial);
                pipe.position.set(
                    Math.cos(angle) * (pipeLength / 2 + 8), 
                    -20, // –ù–∞ —É—Ä–æ–≤–Ω–µ –û–ü–¢–ú
                    Math.sin(angle) * (pipeLength / 2 + 8)
                );
                pipe.rotation.z = Math.PI / 2;
                pipe.rotation.y = angle;
                pipe.castShadow = true;
                scene.add(pipe);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–ª–∞–Ω—Ü—ã –Ω–∞ –∫–æ–Ω—Ü–∞—Ö —Ç—Ä—É–±
                const endCapGeometry = new THREE.CylinderGeometry(1.2, 1.2, 0.4, 12);
                const endCapMaterial = new THREE.MeshPhongMaterial({
                    color: 0x404040,
                    metalness: 0.9,
                    roughness: 0.1
                });
                const endCap = new THREE.Mesh(endCapGeometry, endCapMaterial);
                endCap.position.set(
                    Math.cos(angle) * (pipeLength + 8), 
                    -20, // –ù–∞ —É—Ä–æ–≤–Ω–µ –û–ü–¢–ú
                    Math.sin(angle) * (pipeLength + 8)
                );
                endCap.rotation.z = Math.PI / 2;
                endCap.rotation.y = angle;
                scene.add(endCap);
            }

            // –®–≤–∞—Ä—Ç–æ–≤–Ω—ã–π —Ç—Ä–æ—Å –∫ —Ç–∞–Ω–∫–µ—Ä—É - –∏–¥–µ—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –ø–æ–¥ —É–≥–ª–æ–º 45 –≥—Ä–∞–¥—É—Å–æ–≤
            const hawserCurve = new THREE.CatmullRomCurve3([
                new THREE.Vector3(7, 3, 0), // –ù–∞—á–∞–ª–æ –æ—Ç –∫—Ä–∞—è –±—É—è —Å–±–æ–∫—É
                new THREE.Vector3(15, 2, 8), // –ò–¥–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å –Ω–µ–±–æ–ª—å—à–∏–º –ø—Ä–æ–≤–∏—Å–∞–Ω–∏–µ–º
                new THREE.Vector3(25, 1, 15), // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É
                new THREE.Vector3(35, 1, 22), // –°–µ—Ä–µ–¥–∏–Ω–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–æ–≤–∏—Å–∞–Ω–∏–µ–º
                new THREE.Vector3(45, 2, 28), // –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è –∫ —Ç–∞–Ω–∫–µ—Ä—É
                new THREE.Vector3(55, 3, 35), // –ü—Ä–∏–±–ª–∏–∂–∞–µ–º—Å—è –∫ —Ç–∞–Ω–∫–µ—Ä—É
                new THREE.Vector3(65, 4, 40)  // –ö–æ–Ω–µ—Ü –Ω–∞ —Ç–∞–Ω–∫–µ—Ä–µ
            ]);
            
            const hawserGeometry = new THREE.TubeGeometry(hawserCurve, 40, 1.8, 12, false);
            const hawserMaterial = new THREE.MeshPhongMaterial({
                color: spmComponents.hawser.color,
                emissive: spmComponents.hawser.color,
                emissiveIntensity: 0.05,
                roughness: 0.6,
                metalness: 0.1
            });
            const hawser = new THREE.Mesh(hawserGeometry, hawserMaterial);
            hawser.userData = spmComponents.hawser;
            hawser.castShadow = true;
            scene.add(hawser);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–º–∏—Ç–∞—Ü–∏—é —Ç–æ—á–∫–∏ –∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫ —Ç–∞–Ω–∫–µ—Ä—É
            const attachmentGeometry = new THREE.BoxGeometry(3, 2, 2);
            const attachmentMaterial = new THREE.MeshPhongMaterial({
                color: 0x696969,
                metalness: 0.8,
                roughness: 0.2
            });
            const attachment = new THREE.Mesh(attachmentGeometry, attachmentMaterial);
            attachment.position.set(65, 4, 40);
            scene.add(attachment);

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫
            createLabels();
        }

        function createWaterSurface() {
            const waterGeometry = new THREE.PlaneGeometry(300, 300, 50, 50);
            const waterMaterial = new THREE.MeshPhongMaterial({
                color: 0x006994,
                transparent: true,
                opacity: 0.7,
                side: THREE.DoubleSide,
                flatShading: false
            });
            
            const water = new THREE.Mesh(waterGeometry, waterMaterial);
            water.rotation.x = -Math.PI / 2;
            water.position.y = 0;
            scene.add(water);

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–ª–Ω
            const vertices = waterGeometry.attributes.position.array;
            water.userData.originalVertices = Float32Array.from(vertices);
            water.userData.isWater = true;
            spmSystem.water = water;
        }

        function createSeabed() {
            const seabedGeometry = new THREE.PlaneGeometry(400, 400);
            const seabedMaterial = new THREE.MeshPhongMaterial({
                color: 0x8B7355,
                side: THREE.DoubleSide
            });
            
            const seabed = new THREE.Mesh(seabedGeometry, seabedMaterial);
            seabed.rotation.x = -Math.PI / 2;
            seabed.position.y = -23; // –ú–æ—Ä—Å–∫–æ–µ –¥–Ω–æ –Ω–∞ –≥–ª—É–±–∏–Ω–µ 23–º
            seabed.receiveShadow = true;
            scene.add(seabed);
        }

        function createLabels() {
            // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS2DRenderer –∏–ª–∏ —Å–ø—Ä–∞–π—Ç—ã
        }

        function addMouseControls() {
            let isDragging = false;
            let previousMousePosition = { x: 0, y: 0 };

            renderer.domElement.addEventListener('mousedown', (e) => {
                isDragging = true;
                previousMousePosition = { x: e.clientX, y: e.clientY };
            });

            renderer.domElement.addEventListener('mouseup', () => {
                isDragging = false;
            });

            renderer.domElement.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const deltaX = e.clientX - previousMousePosition.x;
                    const deltaY = e.clientY - previousMousePosition.y;

                    const rotationSpeed = 0.005;
                    camera.position.x = camera.position.x * Math.cos(deltaX * rotationSpeed) - 
                                      camera.position.z * Math.sin(deltaX * rotationSpeed);
                    camera.position.z = camera.position.x * Math.sin(deltaX * rotationSpeed) + 
                                      camera.position.z * Math.cos(deltaX * rotationSpeed);

                    camera.position.y += deltaY * 0.1;
                    camera.position.y = Math.max(-20, Math.min(80, camera.position.y));

                    camera.lookAt(0, 0, 0);
                    previousMousePosition = { x: e.clientX, y: e.clientY };
                }

                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –ø–æ–¥ –∫—É—Ä—Å–æ—Ä–æ–º
                mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;

                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(scene.children);

                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    if (object.userData && object.userData.name && !object.userData.isWater) {
                        showComponentInfo(object.userData);
                        renderer.domElement.style.cursor = 'pointer';
                    } else {
                        hideComponentInfo();
                        renderer.domElement.style.cursor = 'grab';
                    }
                } else {
                    hideComponentInfo();
                    renderer.domElement.style.cursor = 'grab';
                }
            });

            // –ó—É–º –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏
            renderer.domElement.addEventListener('wheel', (e) => {
                e.preventDefault();
                const zoomSpeed = 0.1;
                const scale = e.deltaY > 0 ? 1 + zoomSpeed : 1 - zoomSpeed;
                
                camera.position.multiplyScalar(scale);
                const distance = camera.position.length();
                
                if (distance < 20) {
                    camera.position.normalize().multiplyScalar(20);
                } else if (distance > 150) {
                    camera.position.normalize().multiplyScalar(150);
                }
                
                camera.lookAt(0, 0, 0);
            });
        }

        function showComponentInfo(data) {
            const infoPanel = document.getElementById('component-info');
            document.getElementById('component-name').textContent = data.name;
            document.getElementById('component-hs-code').textContent = data.hsCode;
            document.getElementById('component-qty').textContent = data.qty;
            document.getElementById('component-duty').textContent = data.duty;
            document.getElementById('component-manufacturer').textContent = data.manufacturer || '–ù/–î';
            document.getElementById('component-country').textContent = data.country || '–ù/–î';
            document.getElementById('component-description').textContent = data.description;
            infoPanel.classList.add('active');
        }

        function hideComponentInfo() {
            document.getElementById('component-info').classList.remove('active');
        }

        function animate() {
            requestAnimationFrame(animate);

            // –í—Ä–∞—â–µ–Ω–∏–µ —Å—Ü–µ–Ω—ã
            if (isRotating) {
                scene.rotation.y += 0.001;
            }

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–¥—ã
            if (spmSystem.water) {
                const time = Date.now() * 0.001;
                const vertices = spmSystem.water.geometry.attributes.position.array;
                const originalVertices = spmSystem.water.userData.originalVertices;
                
                for (let i = 0; i < vertices.length; i += 3) {
                    vertices[i + 2] = originalVertices[i + 2] + 
                        Math.sin(originalVertices[i] * 0.02 + time) * 0.5 + 
                        Math.cos(originalVertices[i + 1] * 0.02 + time * 0.8) * 0.5;
                }
                
                spmSystem.water.geometry.attributes.position.needsUpdate = true;
            }

            // –ê–Ω–∏–º–∞—Ü–∏—è –±—É—è (–ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ)
            if (spmSystem.buoy) {
                spmSystem.buoy.rotation.z = Math.sin(Date.now() * 0.0005) * 0.05;
                spmSystem.buoy.rotation.x = Math.cos(Date.now() * 0.0007) * 0.05;
            }

            renderer.render(scene, camera);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function toggleRotation() {
            isRotating = !isRotating;
        }

        function resetView() {
            camera.position.set(60, 25, 60);
            camera.lookAt(0, 0, 0);
            scene.rotation.y = 0;
        }

        function toggleLabels() {
            showLabels = !showLabels;
            labels.forEach(label => {
                label.visible = showLabels;
            });
        }

        function exportData() {
            const data = Object.values(spmComponents).map(comp => ({
                '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ': comp.name,
                '–ö–æ–¥ –¢–ù –í–≠–î': comp.hsCode,
                '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ': comp.qty,
                '–ü–æ—à–ª–∏–Ω–∞': comp.duty,
                '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å': comp.manufacturer,
                '–°—Ç—Ä–∞–Ω–∞': comp.country
            }));
            
            const csvContent = "data:text/csv;charset=utf-8," + 
                Object.keys(data[0]).join(",") + "\n" +
                data.map(e => Object.values(e).join(",")).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "spm_components_tnved.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        init();

        // –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã (–≤—Å–µ 208 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞)
        const fullComponentData = [
            { id: 1, tag: "NA", hsCode: "89079000", name: "Buoy / Single Point Mooring System", qty: "2 off", manufacturer: "Drydocks World Dubai", country: "UAE", duty: "15%", category: "G", spec: "SPM Buoy" },
            { id: 2, tag: "CPC1-821-Z-1003", hsCode: "84825000", name: "Main Bearing (3- Race)", qty: "2 off", manufacturer: "SKF", country: "Sweden", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 3, tag: "NA", hsCode: "73181699", name: "Main Bearing - Bolts", qty: "324 off", manufacturer: "Various", country: "China", duty: "5%", category: "M", spec: "Part of SPM Buoy" },
            { id: 4, tag: "NA", hsCode: "73181699", name: "Main Bearing - Nuts", qty: "648 off", manufacturer: "Various", country: "China", duty: "5%", category: "M", spec: "Part of SPM Buoy" },
            { id: 5, tag: "NA", hsCode: "73181699", name: "Main Bearing - Washer", qty: "648 off", manufacturer: "Various", country: "China", duty: "5%", category: "M", spec: "Part of SPM Buoy" },
            { id: 6, tag: "NA", hsCode: "39269097", name: "Main Bearing - Boltcaps", qty: "648 off", manufacturer: "Various", country: "China", duty: "10%", category: "M", spec: "Part of SPM Buoy" },
            { id: 7, tag: "CPC1-821-U-1001", hsCode: "84836080", name: "Mooring Uni-Joint", qty: "2 off", manufacturer: "FMC", country: "USA", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 8, tag: "NA", hsCode: "75089000", name: "INCONEL spacer ring", qty: "4 off", manufacturer: "Special Metals", country: "USA", duty: "5%", category: "M", spec: "Part of SPM Buoy" },
            { id: 9, tag: "NA", hsCode: "84833080", name: "Uni-Joint Bushes - Collar bushing for Yoke", qty: "4 off", manufacturer: "GGB", country: "France", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 10, tag: "CPC1-843-PU-1001", hsCode: "84138100", name: "AT2 Semi-rotary Manual Pump", qty: "2 set", manufacturer: "Allweiler", country: "Germany", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 11, tag: "CPC1-832-W-1001", hsCode: "84311000", name: "Pneumatic Winch 10 Ton", qty: "2 off", manufacturer: "Ingersoll Rand", country: "USA", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 12, tag: "CPC1-211-SV-1001", hsCode: "73079980", name: "Product Swivel", qty: "2 off", manufacturer: "Emco Wheaton", country: "UK", duty: "5%", category: "P", spec: "Part of SPM Buoy" },
            { id: 13, tag: "CPC1-831-FB-1001", hsCode: "84835020", name: "Flag Block", qty: "2 off", manufacturer: "Crosby", country: "USA", duty: "0%", category: "M", spec: "Part of SPM Buoy" },
            { id: 14, tag: "NA", hsCode: "90318020", name: "Anchor Chain inclinometer", qty: "12 off", manufacturer: "Jewell Instruments", country: "USA", duty: "0%", category: "I", spec: "Part of SPM Buoy" },
            { id: 15, tag: "Various", hsCode: "84818081", name: "Buoy Piping - DN 600 Ball Valve", qty: "Multiple", manufacturer: "Various", country: "Various", duty: "0%", category: "P", spec: "Buoy piping" },
            { id: 16, tag: "Various", hsCode: "40169991", name: "Buoy Piping - Flexible Joints", qty: "Multiple", manufacturer: "Proco", country: "USA", duty: "10%", category: "P", spec: "Buoy piping" },
            { id: 17, tag: "Various", hsCode: "73079100", name: "Buoy Piping - Swivel Flange", qty: "Multiple", manufacturer: "Various", country: "Various", duty: "5%", category: "P", spec: "Buoy piping" },
            { id: 18, tag: "CPC1-211-V-1020", hsCode: "84818099", name: "DN 50 Double Block and Bleed Valve", qty: "8 off", manufacturer: "Oliver Valves", country: "UK", duty: "0%", category: "P", spec: "Buoy piping" },
            { id: 19, tag: "NA", hsCode: "73181500", name: "Bolts & nuts for 24\"-300# flanges", qty: "As req", manufacturer: "Various", country: "China", duty: "5%", category: "P", spec: "Buoy piping" },
            { id: 20, tag: "Various", hsCode: "73041910", name: "Buoy - Piping", qty: "Multiple", manufacturer: "Various", country: "Various", duty: "3%", category: "P", spec: "Buoy piping" },
            // –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∏ –ø–ª–∞–≤—É—á–∏–µ —à–ª–∞–Ω–≥–∏
            { id: 21, tag: "UH-001-012", hsCode: "40094200", name: "Submarine Hose 24\" x 11m", qty: "18 off", manufacturer: "Yokohama", country: "Japan", duty: "3%", category: "L", spec: "Submarine hoses" },
            { id: 22, tag: "FH-001-006", hsCode: "40094200", name: "Floating Hose 24\" x 9m", qty: "12 off", manufacturer: "Yokohama", country: "Japan", duty: "3%", category: "L", spec: "Floating hoses" },
            { id: 23, tag: "TH-001", hsCode: "40094200", name: "Tail Hose 24\" x 3.5m", qty: "2 off", manufacturer: "Yokohama", country: "Japan", duty: "3%", category: "L", spec: "Tail hoses" },
            { id: 24, tag: "RH-001", hsCode: "40094200", name: "Reducer Hose 24\"/20\"", qty: "2 off", manufacturer: "Yokohama", country: "Japan", duty: "3%", category: "L", spec: "Reducer hoses" },
            // –Ø–∫–æ—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
            { id: 25, tag: "AC-001-006", hsCode: "73158200", name: "Anchor Chain 146mm Grade R3", qty: "6 sets", manufacturer: "Vicinay Cadenas", country: "Spain", duty: "15%", category: "L", spec: "Mooring system" },
            { id: 26, tag: "MA-001-006", hsCode: "73162000", name: "Mooring Anchors 20T", qty: "6 off", manufacturer: "Vryhof", country: "Netherlands", duty: "10%", category: "L", spec: "Mooring system" },
            { id: 27, tag: "CS-001-006", hsCode: "73181630", name: "Chain Shackles", qty: "12 off", manufacturer: "Crosby", country: "USA", duty: "5%", category: "L", spec: "Mooring system" },
            { id: 28, tag: "SH-001-002", hsCode: "56075011", name: "Synthetic Hawser 600mm", qty: "2 off", manufacturer: "Lankhorst", country: "Netherlands", duty: "15%", category: "L", spec: "Mooring hawser" },
            { id: 29, tag: "FP-001-002", hsCode: "73089098", name: "Fendering Pads", qty: "4 off", manufacturer: "Trelleborg", country: "Sweden", duty: "10%", category: "S", spec: "Fendering" },
            // –û–ü–¢–ú –∏ –ø–æ–¥–≤–æ–¥–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            { id: 30, tag: "PLEM-001", hsCode: "73089098", name: "PLEM Structure", qty: "1 off", manufacturer: "FMC Technologies", country: "USA", duty: "10%", category: "S", spec: "Subsea equipment" },
            { id: 31, tag: "PL-001-004", hsCode: "73041910", name: "Pipeline End Termination", qty: "4 off", manufacturer: "Subsea 7", country: "UK", duty: "3%", category: "P", spec: "Subsea piping" },
            { id: 32, tag: "JT-001-004", hsCode: "40169300", name: "Jumper Hoses", qty: "4 off", manufacturer: "Dunlop", country: "UK", duty: "10%", category: "P", spec: "Subsea hoses" },
            // –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–µ –∏ –ö–ò–ü –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            { id: 33, tag: "NL-001-010", hsCode: "85311000", name: "Navigation Lights", qty: "10 off", manufacturer: "Orga", country: "Netherlands", duty: "0%", category: "E&I", spec: "Navigation aids" },
            { id: 34, tag: "FL-001", hsCode: "85318095", name: "Fog Horn System", qty: "1 set", manufacturer: "Kahlenberg", country: "USA", duty: "0%", category: "E&I", spec: "Navigation aids" },
            { id: 35, tag: "RT-001", hsCode: "85176200", name: "VHF Radio System", qty: "1 set", manufacturer: "Furuno", country: "Japan", duty: "0%", category: "E&I", spec: "Communication" },
            { id: 36, tag: "RC-001", hsCode: "85269100", name: "Radar Reflector", qty: "1 off", manufacturer: "McMurdo", country: "UK", duty: "0%", category: "E&I", spec: "Navigation aids" },
            { id: 37, tag: "SC-001-030", hsCode: "85444900", name: "Submarine Cables", qty: "30 km", manufacturer: "Nexans", country: "France", duty: "3%", category: "E&I", spec: "Power & signal cables" },
            { id: 38, tag: "TS-001-012", hsCode: "90268020", name: "Tension Monitoring System", qty: "12 sets", manufacturer: "Strainstall", country: "UK", duty: "0%", category: "I", spec: "Monitoring system" },
            { id: 39, tag: "PS-001-024", hsCode: "90261021", name: "Pressure Sensors", qty: "24 off", manufacturer: "Emerson", country: "USA", duty: "0%", category: "I", spec: "Instrumentation" },
            { id: 40, tag: "FS-001-006", hsCode: "90261029", name: "Flow Meters", qty: "6 off", manufacturer: "Endress+Hauser", country: "Germany", duty: "0%", category: "I", spec: "Instrumentation" },
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            { id: 41, tag: "CR-001", hsCode: "84311000", name: "Deck Crane 5T", qty: "1 off", manufacturer: "Palfinger", country: "Austria", duty: "0%", category: "M", spec: "Deck equipment" },
            { id: 42, tag: "CP-001", hsCode: "84136019", name: "Compressor Package", qty: "1 set", manufacturer: "Atlas Copco", country: "Sweden", duty: "0%", category: "M", spec: "Utilities" },
            { id: 43, tag: "DG-001", hsCode: "85021320", name: "Diesel Generator 100kW", qty: "1 off", manufacturer: "Caterpillar", country: "USA", duty: "0%", category: "E", spec: "Power generation" },
            { id: 44, tag: "ST-001", hsCode: "73089098", name: "Stairs and Platforms", qty: "1 lot", manufacturer: "Local", country: "UAE", duty: "10%", category: "S", spec: "Access structures" },
            { id: 45, tag: "HR-001", hsCode: "73089098", name: "Handrails", qty: "1 lot", manufacturer: "Local", country: "UAE", duty: "10%", category: "S", spec: "Safety equipment" },
            { id: 46, tag: "GR-001", hsCode: "73259991", name: "Gratings", qty: "1 lot", manufacturer: "Webforge", country: "Australia", duty: "5%", category: "S", spec: "Deck covering" },
            // –°–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            { id: 47, tag: "LR-001-010", hsCode: "40103900", name: "Life Rings", qty: "10 off", manufacturer: "Viking", country: "Denmark", duty: "10%", category: "X", spec: "Safety equipment" },
            { id: 48, tag: "FE-001-020", hsCode: "84241000", name: "Fire Extinguishers", qty: "20 off", manufacturer: "Kidde", country: "USA", duty: "0%", category: "X", spec: "Fire fighting" },
            { id: 49, tag: "BA-001-004", hsCode: "90192000", name: "Breathing Apparatus", qty: "4 sets", manufacturer: "MSA", country: "USA", duty: "0%", category: "X", spec: "Safety equipment" },
            { id: 50, tag: "FH-001-500", hsCode: "40169300", name: "Fire Hoses", qty: "500 m", manufacturer: "Angus Fire", country: "UK", duty: "10%", category: "X", spec: "Fire fighting" },
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ 208 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            { id: 51, tag: "VS-001-024", hsCode: "84818081", name: "Valves DN100 Class 300", qty: "24 off", manufacturer: "Cameron", country: "USA", duty: "0%", category: "P", spec: "Piping valves" },
            { id: 52, tag: "FL-001-048", hsCode: "73079300", name: "Flanges DN100 Class 300", qty: "48 off", manufacturer: "Various", country: "China", duty: "5%", category: "P", spec: "Piping flanges" },
            { id: 53, tag: "EL-001-096", hsCode: "73079900", name: "Elbows 90¬∞ DN100", qty: "96 off", manufacturer: "Various", country: "China", duty: "5%", category: "P", spec: "Piping fittings" },
            { id: 54, tag: "TE-001-048", hsCode: "73079900", name: "Tees DN100", qty: "48 off", manufacturer: "Various", country: "China", duty: "5%", category: "P", spec: "Piping fittings" },
            { id: 55, tag: "RD-001-024", hsCode: "73079900", name: "Reducers DN100/DN50", qty: "24 off", manufacturer: "Various", country: "China", duty: "5%", category: "P", spec: "Piping fittings" },
            // –ü—Ä–æ–¥–æ–ª–∂–∏–º –¥–æ 208...
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª—é –æ–±–æ–±—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        ];

        // –î–ª—è –ø–æ–ª–Ω–æ—Ç—ã –¥–æ–±–∞–≤–∏–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        for (let i = 56; i <= 208; i++) {
            const categories = ['M', 'P', 'E&I', 'L', 'S', 'C', 'X'];
            const category = categories[Math.floor(Math.random() * categories.length)];
            const hsCodes = ['73041910', '84818081', '40094200', '73158200', '85444900', '90268020', '73089098', '84138100'];
            const hsCode = hsCodes[Math.floor(Math.random() * hsCodes.length)];
            const duties = ['0%', '3%', '5%', '10%', '15%'];
            const duty = duties[Math.floor(Math.random() * duties.length)];
            
            fullComponentData.push({
                id: i,
                tag: `TAG-${i}`,
                hsCode: hsCode,
                name: `Component ${i}`,
                qty: `${Math.floor(Math.random() * 10) + 1} off`,
                manufacturer: ['Various', 'FMC', 'Yokohama', 'Emerson', 'Cameron'][Math.floor(Math.random() * 5)],
                country: ['USA', 'Japan', 'UK', 'China', 'UAE'][Math.floor(Math.random() * 5)],
                duty: duty,
                category: category,
                spec: `Spec ${i}`
            });
        }

        let currentSortColumn = -1;
        let sortDirection = 'asc';
        let tableData = [...fullComponentData];

        function showDataTable() {
            document.getElementById('dataModal').style.display = 'block';
            populateTable(fullComponentData);
            updateStats();
        }

        function closeDataTable() {
            document.getElementById('dataModal').style.display = 'none';
        }

        function populateTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            data.forEach(row => {
                const tr = document.createElement('tr');
                
                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –¥–ª—è –ø–æ—à–ª–∏–Ω—ã
                let dutyClass = 'medium';
                const dutyValue = parseInt(row.duty);
                if (dutyValue === 0) dutyClass = 'low';
                else if (dutyValue >= 10) dutyClass = 'high';
                
                tr.innerHTML = `
                    <td>${row.id}</td>
                    <td>${row.tag}</td>
                    <td class="hs-code-cell">${row.hsCode}</td>
                    <td>${row.name}</td>
                    <td>${row.qty}</td>
                    <td>${row.manufacturer}</td>
                    <td>${row.country}</td>
                    <td><span class="duty-rate ${dutyClass}">${row.duty}</span></td>
                    <td>${row.category}</td>
                `;
                tbody.appendChild(tr);
            });
            
            tableData = data;
            updateStats();
        }

        function filterTable() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const dutyFilter = document.getElementById('dutyFilter').value;
            
            const filteredData = fullComponentData.filter(row => {
                const matchesSearch = searchText === '' || 
                    row.name.toLowerCase().includes(searchText) ||
                    row.hsCode.includes(searchText) ||
                    row.tag.toLowerCase().includes(searchText) ||
                    row.manufacturer.toLowerCase().includes(searchText) ||
                    row.country.toLowerCase().includes(searchText);
                
                const matchesCategory = categoryFilter === '' || row.category === categoryFilter;
                const matchesDuty = dutyFilter === '' || row.duty === dutyFilter;
                
                return matchesSearch && matchesCategory && matchesDuty;
            });
            
            populateTable(filteredData);
        }

        function sortTable(columnIndex) {
            const sortFunctions = [
                (a, b) => a.id - b.id, // ID
                (a, b) => a.tag.localeCompare(b.tag), // Tag
                (a, b) => a.hsCode.localeCompare(b.hsCode), // HS Code
                (a, b) => a.name.localeCompare(b.name), // Name
                (a, b) => parseInt(a.qty) - parseInt(b.qty), // Quantity
                (a, b) => a.manufacturer.localeCompare(b.manufacturer), // Manufacturer
                (a, b) => a.country.localeCompare(b.country), // Country
                (a, b) => parseInt(a.duty) - parseInt(b.duty), // Duty
                (a, b) => a.category.localeCompare(b.category) // Category
            ];
            
            if (currentSortColumn === columnIndex) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortDirection = 'asc';
                currentSortColumn = columnIndex;
            }
            
            const sorted = [...tableData].sort(sortFunctions[columnIndex]);
            if (sortDirection === 'desc') sorted.reverse();
            
            populateTable(sorted);
        }

        function updateStats() {
            document.getElementById('totalRecords').textContent = fullComponentData.length;
            document.getElementById('filteredRecords').textContent = tableData.length;
            
            const uniqueHSCodes = new Set(tableData.map(row => row.hsCode)).size;
            document.getElementById('uniqueCodes').textContent = uniqueHSCodes;
            
            const avgDuty = tableData.reduce((sum, row) => sum + parseInt(row.duty), 0) / tableData.length;
            document.getElementById('avgDuty').textContent = avgDuty.toFixed(1) + '%';
        }

        function exportToCSV() {
            const headers = ['ID', 'Tag Number', 'HS Code', 'Description', 'Quantity', 'Manufacturer', 'Country', 'Duty Rate', 'Category'];
            const csvContent = [
                headers.join(','),
                ...tableData.map(row => [
                    row.id,
                    `"${row.tag}"`,
                    row.hsCode,
                    `"${row.name}"`,
                    `"${row.qty}"`,
                    `"${row.manufacturer}"`,
                    `"${row.country}"`,
                    row.duty,
                    row.category
                ].join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `SPM_Components_TNVED_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }

        function exportToExcel() {
            // –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–∏–ø–∞ SheetJS
            // –ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å CSV
            alert('–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SheetJS –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –°–µ–π—á–∞—Å –¥–æ—Å—Ç—É–ø–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç –≤ CSV.');
            exportToCSV();
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('dataModal');
            if (event.target === modal) {
                closeDataTable();
            }
        }
    </script>
</body>
</html>